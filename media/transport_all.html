<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sequential Vehicle Animation – CLEAN FINAL</title>

<style>
body {
    background: #cde8ff;
    margin: 0;
    height: 100vh;
    overflow: hidden;
    font-family: Arial, sans-serif;
}

.animation-area {
    position: relative;
    width: 100%;
    height: 70vh;
    margin-top: 5vh;
    overflow: hidden;
    background: linear-gradient(#e3f6ff, #b9ddf4);
}

/* ======================================================================
   ALL VEHICLES USE SAME TRACK — NO DEFAULT ANIMATIONS HERE
====================================================================== */
.vehicle {
    position: absolute;
    width: 20vh;
    bottom: 20vh;       /* same vertical lane */
    left: -30vh;        /* start off-screen */
    opacity: 0;         /* hidden until their turn */
    pointer-events: none;
    z-index: 10;
}

.flipflop {
    width: 14vh;
    bottom: 20vh;
    opacity: 0;
    animation-timing-function: steps(1);  /* <<< FIX FOR NO SLIDING */
}

/* ======================================================================
   ORIGINAL ANIMATIONS — PRESERVED EXACTLY, ONLY CONTROLLED BY JS
====================================================================== */

@keyframes carCycle {

    /* -----------------------
       MOVE RIGHT (slow, uniform)
       ----------------------- */
    0% {
        left: -30vh;
        transform: scaleX(1) rotate(0deg); /* NO wheelie */
    }

    40% {
        left: 110%;
        transform: scaleX(1) rotate(0deg); /* stays flat */
    }

    /* -----------------------
       TURN AROUND (very small tilt)
       ----------------------- */
    45% {
        left: 110%;
        transform: scaleX(1) rotate(0deg);  /* tiny tilt, optional */
    }

    50% {
        left: 110%;
        transform: scaleX(-1) rotate(-4deg); /* face left */
    }

    /* -----------------------
       MOVE LEFT (slow, uniform)
       ----------------------- */
    90% {
        left: -30vh;
        transform: scaleX(-1) rotate(0deg); /* stays flat */
    }

    /* -----------------------
       TURN AGAIN BACK TO RIGHT
       ----------------------- */
    95% {
        left: -30vh;
        transform: scaleX(-1) rotate(0deg);
    }

    100% {
        left: -30vh;
        transform: scaleX(1) rotate(0deg); /* ready again */
    }
}



/* ------------ SCOOTER ------------ */
.scooter { transform-origin: 4vh 100%; }

@keyframes scooterCycle {
    0%   { left: -30vh; transform: scaleX(1) rotate(-20deg); }
    15%  { left: 0vh;   transform: scaleX(1) rotate(-10deg); }
    35%  { left: 50vh;  transform: scaleX(1) rotate(0deg); }

    50%  { left: 110%;  transform: scaleX(1); }

    52%  { transform: scaleX(1) rotate(10deg); }
    55%  { transform: scaleX(-1) rotate(-10deg); }


    85%  { left: -5vh; transform: scaleX(-1); }

    100% { left: -30vh; transform: scaleX(1) rotate(-20deg); }
}

/* ------------ TANK ------------ */
@keyframes tankCycle {
    0%   { left: -30vh; transform: scaleX(1); }
    45%  { left: 110%;  transform: scaleX(1); }
    50%  { transform: scaleX(-1); }
    95%  { left: -30vh; transform: scaleX(-1); }
    100% { left: -30vh; transform: scaleX(1); }
}

.tank .tread {
    position: absolute;
    width: 1.4vh;
    height: 1.4vh;
    background: black;
    border-radius: 50%;
    bottom: 1vh;
    animation: treadSpin .35s linear infinite;
}

@keyframes treadSpin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* ------------ FERRY ------------ */
.ferry { width: 26vh; }

@keyframes ferryCycle {
    0%   { left: -40vh; transform: scaleX(1); }
    50%  { left: 110%; transform: scaleX(1); }
    55%  { transform: scaleX(-1); }
    100% { left: -40vh; transform: scaleX(-1); }
}

@keyframes ferryBob {
    0%,100% { bottom: 20vh; }
    50%     { bottom: 22vh; }
}

@keyframes flipflopCycle {

    /* RESET */
    0%   { opacity: 0; left: -30vh; transform: scaleX(1); }

    /* --------------------------- WALK RIGHT --------------------------- */

    /* STEP 1 */
    3%  { opacity: 1; transform: translateY(-1vh) scaleX(1); }
    6%  { opacity: 1; }
    6.01% { opacity: 0; left: -25vh; }

    /* STEP 2 */
    10% { opacity: 1; transform: translateY(-1vh) scaleX(1); }
    13% { opacity: 1; }
    13.01% { opacity: 0; left: -18vh; }

    /* STEP 3 */
    17% { opacity: 1; transform: translateY(-1vh) scaleX(1); }
    20% { opacity: 1; }
    20.01% { opacity: 0; left: -10vh; }

    /* STEP 4 */
    24% { opacity: 1; transform: translateY(-1vh) scaleX(1); }
    27% { opacity: 1; }
    27.01% { opacity: 0; left: 0vh; }

    /* STEP 5 */
    31% { opacity: 1; transform: translateY(-1vh) scaleX(1); }
    34% { opacity: 1; }
    34.01% { opacity: 0; left: 12vh; }

    /* STEP 6 */
    38% { opacity: 1; transform: translateY(-1vh) scaleX(1); }
    41% { opacity: 1; }
    41.01% { opacity: 0; left: 26vh; }

    /* STEP 7 */
    45% { opacity: 1; transform: translateY(-1vh) scaleX(1); }
    48% { opacity: 1; }
    48.01% { opacity: 0; left: 40vh; }

    /* TURN */
    50% { opacity: 0; transform: scaleX(-1); }

    /* --------------------------- WALK LEFT --------------------------- */

    /* STEP 8 */
    55% { opacity: 1; left: 40vh; transform: translateY(-1vh) scaleX(-1); }
    58% { opacity: 1; }
    58.01% { opacity: 0; left: 26vh; }

    /* STEP 9 */
    62% { opacity: 1; transform: translateY(-1vh) scaleX(-1); }
    65% { opacity: 1; }
    65.01% { opacity: 0; left: 12vh; }

    /* STEP 10 */
    69% { opacity: 1; transform: translateY(-1vh) scaleX(-1); }
    72% { opacity: 1; }
    72.01% { opacity: 0; left: 0vh; }

    /* STEP 11 */
    76% { opacity: 1; transform: translateY(-1vh) scaleX(-1); }
    79% { opacity: 1; }
    79.01% { opacity: 0; left: -10vh; }

    /* STEP 12 */
    83% { opacity: 1; transform: translateY(-1vh) scaleX(-1); }
    86% { opacity: 1; }
    86.01% { opacity: 0; left: -25vh; }

    /* END */
    100% { opacity: 0; left: -30vh; transform: scaleX(1); }
}








</style>
</head>

<body onclick="startSequence()">

<div class="animation-area">

    <img src="media/car.png" class="vehicle car" data-sound="media/car.mp3">

    <img src="media/scooter.png" class="vehicle scooter" data-sound="media/scooter.mp3">

    <div class="vehicle tank" data-sound="media/tank.mp3">
        <img src="media/tank.png" style="width:100%;">
        <div class="tread" style="left:2vh;"></div>
        <div class="tread" style="left:6vh;"></div>
        <div class="tread" style="left:10vh;"></div>
        <div class="tread" style="left:14vh;"></div>
        <div class="tread" style="left:18vh;"></div>
    </div>

    <img src="media/ferry.png" class="vehicle ferry" data-sound="media/ferry.mp3">

    <img src="media/flipflop.png" class="vehicle flipflop" data-sound="media/flipflop.mp3">

</div>

<script>
/* ===================================================================
   SEQUENCE ENGINE — VEHICLES PLAY ONE AFTER ANOTHER
   WITH LOOPED SOUND DURING THEIR MOVEMENT
=================================================================== */

let items = [
    
    { el: document.querySelector(".flipflop"), anim: "flipflopCycle 16s steps(1) forwards", dur: 16000 },
{ el: document.querySelector(".car"),      anim: "carCycle 25s linear forwards",            dur: 25000 },
    { el: document.querySelector(".scooter"),  anim: "scooterCycle 11s linear forwards",        dur: 11000 },
    { el: document.querySelector(".tank"),     anim: "tankCycle 40s linear forwards",           dur: 40000 },
    { el: document.querySelector(".ferry"),    anim: "ferryCycle 30s linear forwards, ferryBob 4s ease-in-out infinite", dur: 30000 }
];

let index = 0;

function playVehicle(i) {

    let v = items[i].el;
    let anim = items[i].anim;
    let dur  = items[i].dur;

    v.style.opacity = 1;
    v.style.left = "-30vh";

    /* Reset & apply animation */
    v.style.animation = "none";
    void v.offsetWidth;
    v.style.animation = anim;

    /* Play looped sound */
    let sound = new Audio(v.dataset.sound);
    sound.loop = true;
    sound.volume = 1;
    sound.play();

    /* On animation end */
    setTimeout(() => {
        sound.pause();
        sound.currentTime = 0;

        v.style.opacity = 0;
        v.style.animation = "none";

        index = (index + 1) % items.length;
        setTimeout(() => playVehicle(index), 400);

    }, dur);
}

function startSequence() {
    playVehicle(index);
    document.body.onclick = null; // audio unlock done
}
</script>

</body>
</html>
